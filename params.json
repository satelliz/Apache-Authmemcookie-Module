{
  "name": "Apache-authmemcookie-module",
  "tagline": "\"Auth MemCookie\" is an Apache v2.0 Authentication and authorization modules are based on \"cookie\" Authentication mechanism",
  "body": "# What is \"Auth MemCookie\"?\r\n\r\n\"Auth MemCookie\" is an Apache v2.0 Authentication and authorization modules are based on \"cookie\" Authentication mechanism.\r\n\r\nThe module doesnâ€™t make Authentication by it self, but verify if Authentication \"the cookie\" is valid for each url protected by the module. The module validate also if the \"authenticated user\" have authorization to access url.\r\n\r\nAuthentication is made externally by an Authentication html form page and all Authentication information necessary to the module a stored in memcached identified by the cookie value \"Authentication session id\" by this login page.\r\n\r\n# How it Works\r\n\r\n## Phase 1 : The login Form\r\n\r\nAuthentication is made by a login form page.\r\n\r\nThis login page must authenticate the user with any authenticate source (ldap, /etc/password, file, database....) accessible to language of the page (php, perl, java... an ldap login page sample in php are in samples directory).\r\n\r\nThen this page must set cookie that contains only a key the \"Authentication unique id\" of the \"Authentication session\".\r\n\r\nThe login page must store authorization and user information of the authenticated user in memcached identified by the cookie key \"Authentication unique id\".\r\n\r\nThe login page can be developed in any language you want, but must be capable to use memcached (they must have memcache client api for us)\r\n\r\n## Phase 2 : The Apache v2 Module\r\n\r\nAfter the user is logged, the apache 2 module check on each protected page by apache ACL the presence of the \"cookie\".\r\n\r\nIf the \"cookie\" exists, try to get session in [memcached](http://memcached.org/) with the \"cookie\" value if not found return \"**HTTP_UNAUTHORIZED**\" page. \r\n\r\nIf session exists in [memcached](http://memcached.org/) verify if ACL match user session information if not match return \"**HTTP_FORBIDDEN**\" page. \r\n\r\n# Session format stored in memcached\r\n\r\nThe session store in [memcached](http://memcached.org/) are composed with multiple line in form of \"**name**\" equal \"**value**\" ended by \"**\\r\\n**\". some are mandatory, other are optional and the rest are information only (all this field are transmitted to the script language protect the module).\r\n\r\nSession format:\r\n\r\n    UserName=<user name>\\r\\n\r\n    Groups=<group name1>:<group name2>:...\\r\\n\r\n    RemoteIP=<remote ip>\\r\\n\r\n    Password=<password>\\r\\n\r\n    Expiration=<expiration time>\\r\\n\r\n    Email=<email>\\r\\n\r\n    Name=<name>\\r\\n\r\n    GivenName=<given name>\\r\\n\r\n\r\n- **Username**: are mandatory.\r\n- **Groups**: are mandatory, are used to check group in apache acl. if no group are know for the user, must be blank (Groups=\\r\\n)\r\n- **RemoteIP**: are mandatory, used by remote ip check function in apache module.\r\n- **Password**: are not mandatory, and is not recommended to store in memcached for security reson, but if stored, is sent to the script language protected by the module.\r\n- The other fields are information only, but they are sent to the langage that are behind the module (via environement variable or http header).\r\n\r\nThe session field size is for the moment limited to 10 fields by default.\r\n\r\n# Build dependency\r\n\r\nYou must have compiled and installed:\r\n\r\n- [libevent](http://libevent.org/) use by [memcached](http://memcached.org/).\r\n\r\n- [memcached](http://memcached.org/) the cache daemon it self.\r\n\r\n- [libmemcached](http://libmemcached.org/) the C client API needed to compile the Apache Module.\r\n\r\n# Compilation\r\n\r\n```\r\n# ./configure --with-apxs=/path/to/apache/httpd/bin/apxs --with-libmemcached=/path/to/libmemcached/\r\n# make\r\n# make install\r\n```\r\n\r\nAfter that the \"mod_auth_memcookie.so\" is generated in apache \"modules\" directory.\r\n\r\n# How to configure Apache Module\r\n\r\n## Module configuration option:\r\n\r\nThis option can be used in \"location\" or \"directory\" apache context.\r\n\r\n- **Auth_memCookie_Memcached_Configuration**\r\n\r\nThis configuration directive permit to configure libmemcached initialisation.\r\nThe syntax of this directive value are defined her: http://docs.libmemcached.org/libmemcached_configuration.html\r\n\r\nWith that directive you can specify a liste of ip or host adresse(s) and port ':' separed of memcache(s) daemon to be used.\r\n\r\nFor exemple: \r\n```\r\n    Auth_memCookie_Memcached_Configuration \"--SERVER=host10.example.com --SERVER=host11.example.com --SERVER=host10.example.com\"\r\n```\r\n- **Auth_memCookie_Memcached_SessionObject_ExpireTime**\r\n\r\nSession object stored in memcached expiry time, in secondes. \r\nUsed only if \"Auth_memCookie_Memcached_SessionObject_ExpiryReset\" is set to on.\r\nSet to 3600 seconds by default.\r\n- **Auth_memCookie_Memcached_SessionObject_ExpiryReset**\r\n\r\nSet to 'no' to not reset object expiry time in memcache on each url... set to yes by default\r\n- **Auth_memCookie_SessionTableSize**\r\n\r\nMax number of element in session information table. set to 10 by default.\r\n- **Auth_memCookie_SetSessionHTTPHeader**\r\n\r\nSet to 'yes' to set session information to http header of the authenticated users, set to no by default.\r\n- **Auth_memCookie_SetSessionHTTPHeaderEncode**\r\n\r\nSet to 'yes' to mime64 encode session information to http header, set to no by default.\r\n- **Auth_memCookie_CookieName**\r\n\r\nName of the cookie to used for check authentification, set to \"AuthMemCookie\" by default.\r\n- **Auth_memCookie_MatchIP**\r\n\r\nSet to 'no' to not check IP address set in cookie with the remote browser ip, set to 'yes' by default.\r\n- **Auth_memCookie_GroupAuthoritative**\r\n\r\nSet to 'no' to allow access control to be passed along to lower modules, for group acl check. set to 'yes' by default.\r\n- **Auth_memCookie_Authoritative**\r\n\r\nSet to 'yes' to allow access control to be passed along to lower modules.Set to 'no' by default.\r\n- **Auth_memCookie_SilmulateAuthBasic**\r\n\r\nSet to 'no' to not fix http header and auth_type for simulating auth basic for scripting language like php auth framework work., set to 'yes' by default\r\n\r\n## Sample to configure Apache v2 Module:\r\n\r\nConfiguration sample for using Auth_memcookie apache V2 module:\r\n\r\n    LoadModule mod_auth_memcookie_module modules/mod_auth_memcookie.so\r\n\r\n    <IfModule mod_auth_memcookie.c>\r\n     <Location />\r\n     Auth_memCookie_CookieName myauthcookie\r\n     Auth_memCookie_Memcached_Configuration --SERVER=127.0.0.1:11000\r\n\r\n     # to redirect unauthorized user to the login page\r\n     ErrorDocument 401 \"/gestionuser/login.php\"\r\n\r\n     # to specify if the module are autoritative in this directory\r\n     Auth_memCookie_Authoritative on\r\n     # must be set without that the refuse authentification\r\n     AuthType Cookie\r\n     # must be set (apache mandatory) but not used by the module\r\n     AuthName \"My Login\"\r\n     </Location>\r\n\r\n    </IfModule>\r\n\r\n    # to protect juste user authentification\r\n    <Location \"/myprotectedurl\">\r\n     require valid-user\r\n    </Location>\r\n\r\n    # to protect acces to user in group1\r\n    <Location \"/myprotectedurlgroup1\">\r\n     require group group1\r\n    </Location>\r\n\r\n",
  "google": "",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}